<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Heart Pro - Custom AR Gestures</title>
    
    <script type="module" src="https://ajax.googleapis.com/ajax/libs/model-viewer/4.0.0/model-viewer.min.js"></script>

    <style>
        :root { --accent-color: #e91e63; }
        body { margin: 0; background: radial-gradient(circle, #fff 0%, #dcdcdc 100%); overflow: hidden; font-family: sans-serif; }

        model-viewer {
            width: 100vw;
            height: 100vh;
            /* Essential: Tells the browser the model handles the touch */
            touch-action: none; 
        }

        /* UI Styling */
        .controls {
            position: absolute; bottom: 40px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 15px; z-index: 100;
            background: rgba(255, 255, 255, 0.8); padding: 12px; border-radius: 50px;
            backdrop-filter: blur(20px); box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .btn {
            padding: 12px 25px; border-radius: 30px; border: none;
            background: #222; color: white; font-weight: bold; cursor: pointer;
            transition: 0.3s; text-transform: uppercase; font-size: 12px;
        }

        .btn.active { background: var(--accent-color); }

        #ar-prompt {
            position: absolute; top: 20px; right: 20px; padding: 15px;
            background: white; border-radius: 12px; font-weight: bold;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1); border: 1px solid #eee;
        }
    </style>
</head>
<body>



<model-viewer 
    id="heartViewer"
    src="./Heartmodel/Android/Heartmodel.glb" 
    ios-src="./Heartmodel/IOS/Heartmodel.usdz"
    
    /* --- AR CONFIGURATION --- */
    ar 
    /* WebXR is the ONLY mode that allows 1-finger rotation in AR on iOS */
    ar-modes="webxr scene-viewer quick-look" 
    ar-placement="floor"
    
    /* --- ROTATION OVERRIDE --- */
    camera-controls
    /* disable-pan forces 1-finger to rotate instead of sliding the camera */
    disable-pan
    interaction-prompt="none"
    interpolation-decay="200"
    
    /* --- VISUALS --- */
    shadow-intensity="1"
    shadow-softness="0.5"
    exposure="1.2"
    environment-image="neutral"
    camera-orbit="0deg 75deg 105%"
    auto-rotate-delay="0">

    <button slot="ar-button" id="ar-prompt">ENTER AR EXPERIENCE</button>
</model-viewer>

<div class="controls">
    <button class="btn active" onclick="updateModel('./Heartmodel/Android/Heartmodel.glb', this)">Heart</button>
    <button class="btn" onclick="updateModel('./Heartmodel/Android/HeartLabels.glb', this)">Labels</button>
</div>



<script>
    const viewer = document.querySelector('#heartViewer');

    function updateModel(path, btn) {
        // Update Buttons
        document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        // Switch Model
        viewer.src = path;
    }

    // Optional: Log when entering AR to confirm mode
    viewer.addEventListener('ar-status', (event) => {
        if(event.detail.status === 'session-started') {
            console.log("AR Started in mode: " + viewer.arMode);
        }
    });
</script>

</body>
</html>
